---
title: 四技專題-物聯網閘道器部署
tags: 四技專題
---
## 00 部署
### 取得專案
- push local 
  ```
    $ git clone https://github.com/zangmen/2023_schoolSideProject.git
  ```
- 到專案資料夾
  ```
    $ cd 2023_schoolSideProject/src/sensor_api
  ```
### 更新專案
- fetch
  ```
    $ git fetch
  ```
- pull
  ```
    $ git pull
  ```
### 映像檔
- 建立映像檔
  ```
    $ sudo sh build.sh
  ```
- 建立且運行容器
  ```
    $ sudo sh run.sh
  ```
- 防火牆
  ```
    $ sudo firewall-cmd --add-port=3095/tcp --permanent
    $ sudo firewall-cmd --add-port=3094/tcp --permanent
    $ sudo firewall-cmd --add-port=3095/udp --permanent
    $ sudo firewall-cmd --add-port=3094/udp --permanent
    $ sudo firewall-cmd --reload
  ```
---
## 01 環境&位置
### 環境: docker
- 把環境容器化
  * API串接的伺服端: nodejs
    * Port
      * HTTP: 3095
      * MQTT: 3094 
  * OS: Alpine Linux
### 架構演示
![](https://i.imgur.com/Kxq8OFv.png)
### 伝送方式
#### HTTP 
![](https://i.imgur.com/3GlPMjG.png)
- 參數
  * `:deviceID`: 開發版編號
  * `?`: Quary String
  * `&`: Separator
  * 定義: 變數名=要傳伝的值
![](https://i.imgur.com/WNnxPKK.png)
#### MQTT
- 訂閱主題
  ```
     /[device_ID]/[Sensor]
  ```
- 回傳
  * 格式: JSON
---